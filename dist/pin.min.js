/** pin.js - v0.0.1 - 2015-06-01
* Copyright (c) 2015 Mauricio Soares;
* Licensed MIT 
*/


!function(a,b){"use strict";function c(a,c){this.el="string"==typeof a?b.querySelector(a):a,this.parent=this.el.parentNode,this.setOptions(c||{}),this.init()}c.prototype.setOptions=function(a){this.options={onPin:void 0!==a.onPin?a.onPin:c.noop,onUnpin:void 0!==a.onUnpin?a.onUnpin:c.noop,onTouchBottom:void 0!==a.onTouchBottom?a.onTouchBottom:c.noop,stopOnBottom:void 0!==a.stopOnBottom?a.stopOnBottom:!0,respectWindow:void 0!==a.respectWindow?a.respectWindow:!0}},c.prototype.init=function(){this.createHelperElement(),this.bind(),this.calcPositions(),this.onWindowScroll()},c.prototype.createHelperElement=function(){this.helperDiv=b.createElement(this.el.tagName),c.setStyle(this.helperDiv,{position:c.getStyle(this.el,"position"),height:c.getStyle(this.el,"height"),width:c.getStyle(this.el,"width"),"float":c.getStyle(this.el,"float"),margin:c.getStyle(this.el,"margin"),padding:c.getStyle(this.el,"padding"),borderTop:c.getStyle(this.el,"borderTop"),borderLeft:c.getStyle(this.el,"borderLeft"),borderRight:c.getStyle(this.el,"borderRight"),borderBottom:c.getStyle(this.el,"borderBottom"),display:"none",visibility:"hidden"}),this.parent.insertBefore(this.helperDiv,this.el)},c.prototype.refreshHelperElementWidth=function(){c.setStyle(this.helperDiv,{width:c.getStyle(this.el,"width")})},c.prototype.showHelperElement=function(a){c.setStyle(this.helperDiv,{display:a===!1?"none":"block"})},c.prototype.destroy=function(){c.setStyle(this.el),this.unbind()},c.prototype.calcPositions=function(){"static"===c.getStyle(this.parent,"position")&&c.setStyle(this.parent,{position:"relative"}),this.positions={offset:this.getOffset(this.el),parentOffset:this.getParentOffset(),stopTop:this.parent.offsetHeight+this.getOffset(this.parent).top-this.el.offsetHeight}},c.prototype.getOffset=function(c){var d=b.documentElement,e=c.getBoundingClientRect();return{top:e.top+a.pageYOffset-d.clientTop,left:e.left+a.pageXOffset-d.clientLeft}},c.prototype.getParentOffset=function(){return{left:this.el.offsetLeft}},c.prototype.bind=function(){this.reloadBind=this.reload.bind(this),this.onWindowScrollBind=this.onWindowScroll.bind(this),a.addEventListener("resize",this.reloadBind),a.addEventListener("scroll",this.onWindowScrollBind)},c.prototype.unbind=function(){a.removeEventListener("resize",this.reloadBind),a.removeEventListener("scroll",this.onWindowScrollBind)},c.prototype.reload=function(){this.showHelperElement(!1),c.setStyle(this.el),this.calcPositions(),this.onWindowScroll(),this.refreshHelperElementWidth()},c.prototype.onWindowScroll=function(){var b;if(!(this.options.respectWindow&&c.windowIsSmaller(this.el)||this.touchBottom()||(b=a.pageYOffset-this.positions.offset.top,b>0&&"fixed"===c.getStyle(this.el,"position")||0>=b&&("relative"===c.getStyle(this.el,"position")||"static"===c.getStyle(this.el,"position"))))){if(b>0)return this.pinElement();c.setStyle(this.el),this.options.onUnpin(this),this.showHelperElement(!1)}},c.prototype.pinElement=function(){c.setStyle(this.el,{position:"fixed",left:c.toPx(this.positions.offset.left),width:c.getStyle(this.el,"width"),top:0,marginLeft:0,marginTop:0,bottom:""}),this.options.onPin(this),this.showHelperElement()},c.prototype.touchBottom=function(){return this.options.stopOnBottom&&a.pageYOffset>this.positions.stopTop?"absolute"===c.getStyle(this.el,"position")?!0:(c.setStyle(this.el,{position:"absolute",width:c.getStyle(this.el,"width"),top:"",bottom:0,left:c.toPx(this.positions.parentOffset.left),marginLeft:""}),this.options.onTouchBottom(this),this.showHelperElement(),!0):!1},c.setStyle=function(a,b){if(!b)return void a.removeAttribute("style");for(var c in b)a.style[c]=b[c]},c.getStyle=function(b,c){return c?a.getComputedStyle(b)[c]:a.getComputedStyle(b)},c.toPx=function(a){return a+"px"},c.windowIsSmaller=function(b){return a.innerHeight<b.offsetHeight},c.init=function(){var a=Array.prototype.slice.call(b.querySelectorAll("[data-pin]"));a.forEach(function(a){new c(a)})},c.noop=function(){},a.Pin=c,"undefined"!=typeof Document&&b.addEventListener("DOMContentLoaded",c.init)}(window,document);
//# sourceMappingURL=pin.min.js.map